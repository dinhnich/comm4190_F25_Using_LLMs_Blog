<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nicholas">
<meta name="dcterms.date" content="2025-09-06">
<meta name="description" content="Can AI serve as a realiable means for data-collection?">

<title>Synthetic Respondents â€“ Nickâ€™s LLM Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a5d1ff6918a2d73efcd6c40a62aa79ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nickâ€™s LLM Experiments</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Synthetic Respondents</h1>
                  <div>
        <div class="description">
          Can AI serve as a realiable means for data-collection?
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">prompting</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nicholas </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 6, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="how-do-synthetic-respondents-reason" class="level2">
<h2 class="anchored" data-anchor-id="how-do-synthetic-respondents-reason">How do Synthetic Respondents Reason?</h2>
<p>One of my courses this year, MKTG 2120 â€œData and Analysis for Marketing Decisionsâ€ proposed an interesting topic about the idea of using AI-powered participants to conduct studies and pre-test content. In fact, one company, Viewpoints.ai has already began putting this into practice. Taking this idea, I wanted to study synthetic respondents, which are AI-generated participants that predict how real demographic groups might answer survey questions. I first began by asking a general survey question using a likert scale without any additional context.</p>
<blockquote class="blockquote">
<p>Me: Please make a rating: Chocolate icecream is delicious. Do you strong disagree, disagree, neutral, agree, strongly agree?</p>
</blockquote>
<blockquote class="blockquote">
<p>GPT-5: Iâ€™d rate that as strongly agree â€” chocolate ice cream is a classic favorite for many people! ğŸ«ğŸ¦</p>
</blockquote>
<p>I had numerous questions I wanted to ask as to how GPT-5 came to <strong>strongly agree</strong>â€¦</p>
<ol type="1">
<li>Did it answer coming from a person or AI standpoint?</li>
<li>Why did it choose to rate based off it being a â€œfavoriteâ€ for many?</li>
<li>What factors did it consider and not consider? (brand, ingredients, etc.)</li>
</ol>
</section>
<section id="and-so-i-did-and-here-is-what-it-said" class="level2">
<h2 class="anchored" data-anchor-id="and-so-i-did-and-here-is-what-it-said">And so I did and here is what it said</h2>
<p>One of my courses this year, MKTG 2120 â€œData and Analysis for Marketing Decisionsâ€ proposed an interesting topic about the idea of using AI-powered participants to conduct studies and pre-test content. In fact, one company, Viewpoints.ai has already began putting this into practice. Taking this idea, I wanted to study synthetic respondents, which are AI-generated participants that predict how real demographic groups might answer survey questions. I first began by asking a general survey question using a likert scale without any additional context.</p>
<p>â€œ<strong>General popularity</strong> â€“ Chocolate ice cream is consistently one of the most popular and widely enjoyed flavors worldwide.</p>
<p><strong>Cultural associations</strong> â€“ Itâ€™s often described positively (comfort food, indulgent, â€œclassicâ€ flavor).</p>
<p><strong>Taste profile</strong> â€“ Chocolate is sweet, rich, and familiar, which makes it appealing to a broad range of people.</p>
<p><strong>Context of your question</strong> â€“ You phrased it as â€œChocolate ice cream is delicious,â€ which is a strongly positive statement.</p>
<p>On a standard agree/disagree scale, the â€œnaturalâ€ response aligns with strong agreement unless I wanted to take a contrarian or neutral stance. I didnâ€™t apply personal taste (since I donâ€™t eat), but I leaned on patterns in human preferences and how survey scales usually work.â€</p>
<p>So it seems like GPT-5 used assumptions about icecream and based on those assumptions, attempted to answer based how a human would respond. Also I noticed how GPT-5 refrained from taking a â€œcontratian or neutral stance.â€ By not wanting to disagree, I can see how this may be a problem in using synthetic respondents as it will give response the surveys might like to hear but not accurate.</p>
</section>
<section id="what-if-i-gave-ai-an-identity" class="level2">
<h2 class="anchored" data-anchor-id="what-if-i-gave-ai-an-identity">What if I gave AI an identity?</h2>
<p>Now that we established how AI makes a decision without context, what if I gave it a specific identity? How might that change itâ€™s output? Instead of general assumptions, will it make assumptions based on the identity?</p>
<blockquote class="blockquote">
<p>Me: Youâ€™re a 45-year-old man who works in finance. You enjoy travelling, reading, and politics. Please rate the extend you agree with this statement: Chocolate icecream is delicious. Do you strong disagree, disagre, neutral, agree, strongly agree?</p>
</blockquote>
<blockquote class="blockquote">
<p>GPT-5: Agree. Chocolate ice cream is enjoyable and tasty, though perhaps not an all-time favorite. Itâ€™s a solid, classic choice that Iâ€™d happily eat, but I might not go so far as â€œstrongly agreeâ€ unless it was a personal indulgence.</p>
</blockquote>
<p>But why did it change itâ€™s answer from <strong>strongly agree</strong> to <strong>agree</strong>, clearly it answered this time as a â€œperson.â€ I decided to ask the same question I did before.</p>
<blockquote class="blockquote">
<p>Me: What factors did you consider when getting to your answer?</p>
</blockquote>
<p>â€œ<strong>Persona maturity &amp; lifestyle</strong> â€“ At mid-life, tastes may be a bit more balanced. Chocolate ice cream is enjoyable, but indulgence might not be the top priority compared with health or variety.</p>
<p><strong>Professional identity</strong> â€“ Working in finance often implies being measured, analytical, and not overly exuberant. That makes â€œagreeâ€ a tempered, moderate response, rather than â€œstrongly agree.â€</p>
<p><strong>Personal interests</strong> â€“ Someone who enjoys traveling might have tried a wide range of desserts and flavors from different cultures. That broad exposure could mean chocolate ice cream is appreciated, but not seen as the absolute best.</p>
<p><strong>Social/cultural norms</strong> â€“ Chocolate is widely liked, so it would feel natural to agree that itâ€™s delicious, but â€œstrongly agreeâ€ might be reserved for a favorite food or something with personal nostalgia attached.â€</p>
</section>
<section id="how-does-it-come-to-these-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="how-does-it-come-to-these-assumptions">How does it come to these assumptions?</h2>
<p>From itâ€™s response, GPT-5 provides clear reasonings behind itâ€™s ratings based on assumptions on age, career, and interests. I found it interesting how AI was able to make multiple assumptions going from finance-&gt;analytical-&gt;not overly exuberant-&gt;moderate and noticed other chains like mid-life-&gt;balanced-&gt;health.</p>
<p>But from itâ€™s responses, it assumed things like how the exposure from travelling may result in chocloate ice cream not being considered the â€œbestâ€ despite travelling not always necessitating different cultures. What if the man meant travelling as in visiting national parks and enjoying nature? What if he did travel but didnâ€™t meet other cultures? What if he did travel to places with different cultures but never tried their sweets or desserts? Several of these counters make it interesting why AI went this route.</p>
</section>
<section id="what-if-i-added-a-random-variable" class="level2">
<h2 class="anchored" data-anchor-id="what-if-i-added-a-random-variable">What if I added a random variable?</h2>
<p>I was curios if the AI output might change if I added something after-the-fact or post itâ€™s decision that gave no real inclination for the decision to change. Would AI overread or possibly imagine something just by me adding it post-decision? Would it read my update as important and a signal for the response to change?</p>
<p>â€œFrom that perspective, the manâ€™s rating might still be agree, but hereâ€™s what influences it now:</p>
<p><strong>Personal enjoyment</strong> â€“ He likes chocolate ice cream enough to say itâ€™s delicious.</p>
<p><strong>Partnerâ€™s influence</strong> â€“ Since his wife dislikes it, he probably eats it less often at home or compromises when sharing desserts. That makes him less likely to say â€œstrongly agree,â€ even if he personally enjoys it.</p>
<p><strong>Social considerations</strong> â€“ In marriage, food choices are often negotiated. If the flavor isnâ€™t a â€œshared favorite,â€ he might moderate his enthusiasm.</p>
<p>Temperament â€“ Given his professional background (finance, analytical, moderate), and the wifeâ€™s preference, â€œagreeâ€ feels like the balanced, realistic answer.</p>
<p>ğŸ‘‰ So his stance is: â€œYes, itâ€™s delicious, but itâ€™s not a big part of my life since my wife isnâ€™t into it.â€</p>
<section id="reflection" class="level3">
<h3 class="anchored" data-anchor-id="reflection">Reflection</h3>
<p>Looks like AI did a good job in not over-reading into that addition and managed to remain consistent to itâ€™s choice while also adding information to the situation the man might have had experiences with.</p>
<p>Overall, I was impressed by how AI was able to come to certain conclusions based on assumptions that most people would call reasonable. However, I fear that AI still has a long way to go before being able to act as real data that a company would rely on or if it could ever replace a human respondent? After all, an ice cream product isnâ€™t being sold to GPT-5 but a 45-year-old man in finance would be one. But how could we ever test itâ€™s accuracy? That is a question Iâ€™ll leave for researchers to find out.</p>
<p>Here is a snapshot of the interaction.</p>
<p><img src="01.png" width="50%"></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/dinhnich\.github\.io\/comm4190_F25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>